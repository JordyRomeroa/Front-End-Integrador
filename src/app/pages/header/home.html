<div class="fixed inset-0 -z-10 animate-gradient-red-black"></div>

@if (loading()) {
  <div class="fixed inset-0 flex flex-col items-center justify-center bg-black/60 z-50">
    <!-- Spinner animado -->
    <div class="w-16 h-16 border-4 border-red-900 border-t-transparent rounded-full animate-spin mb-4"></div>
    
    <!-- Texto de carga -->
    <p class="text-white text-xl font-semibold tracking-wide animate-pulse">
      Cargando tu experiencia...
    </p>
  </div>
} @else {
  <!-- Contenido principal -->

  <!-- SIDEBAR -->
  <aside class="navbar">

    <!-- LOGO -->
    <a routerLink="/home/inicio" class="text-2xl font-bold text-white">Portafolio</a>

    <!-- MENÚ -->
    <nav class="mt-8 flex flex-col space-y-2">
      <a routerLink="/home/inicio" routerLinkActive="active" class="nav-link">Inicio</a>
      <a routerLink="/home/proyectos" routerLinkActive="active" class="nav-link">Proyectos</a>

      <!-- ADMIN -->
      @if (role === 'admin') {
        <div class="relative group">
          <button class="nav-link flex items-center justify-between">
            Panel de control ▼
          </button>
          <div class="absolute left-full top-0 hidden group-hover:block bg-black/80 text-white rounded-lg shadow-xl py-2 w-56">
            <a routerLink="/home/admin" [routerLinkActive]="['active']" class="submenu-item">
              Registrar Programador
            </a>
          </div>
        </div>
      }

      <!-- PROGRAMMER -->
      @if (role === 'programmer') {
        <div class="relative group">
          <button class="nav-link flex items-center justify-between">
            Programador ▼
          </button>
          <div class="absolute left-full top-0 hidden group-hover:block bg-black/80 text-white rounded-lg shadow-xl py-2 w-56">
            <a routerLink="/home/programmer/management" class="submenu-item">Mis proyectos</a>
            <a routerLink="/home/programmer" class="submenu-item">Solicitudes</a>
          </div>
        </div>
      }

      <!-- USER NORMAL -->
      @if (role === 'user') {
        <span class="nav-link">Explorar contenido</span>
      }
    </nav>

   <!-- USER SECTION -->
<div class="mt-auto flex flex-col items-center space-y-3">
  @if (authService.currentUser()) {
    <div class="user-initials">
      {{ getInitials(authService.currentUser()?.email ?? '') }}
    </div>

    <button (click)="logout()" class="bg-red-900 text-white px-3 py-1 rounded hover:bg-red-700 transition transform hover:scale-105">
      Cerrar sesión
    </button>
  } @else {
    <button routerLink="/login" class="bg-red-900 text-white px-3 py-1 rounded hover:bg-red-700 transition transform hover:scale-105">
      Iniciar sesión
    </button>
  }
</div>


  </aside>

  <!-- HERO / CONTENIDO PRINCIPAL -->
  <main class="hero-slide p-6">
    <h2 class="text-4xl md:text-5xl font-bold text-white animate-fadeIn mb-6">
      @if (role === 'user' || role === 'programmer' || role === 'admin') {
        ¡Bienvenido!
      }
    </h2>

    <router-outlet></router-outlet>
  </main>

  <!-- FOOTER -->
  <footer class="bg-white/80 backdrop-blur-md mt-auto shadow-inner py-4 text-center text-gray-500 animate-fadeIn">
    © 2025 MiApp. Todos los derechos reservados.
  </footer>
}
