<div class="fixed inset-0 -z-10 aurora-bg"></div>

@if (loading()) {
  <!-- LOADING -->
  <div class="fixed inset-0 flex flex-col items-center justify-center bg-black/60 z-50">
    <div class="w-16 h-16 border-4 border-red-900 border-t-transparent rounded-full animate-spin mb-4"></div>
    <p class="text-white text-xl font-semibold animate-pulse">
      Cargando tu experiencia...
    </p>
  </div>
} @else {

<div class="min-h-screen flex flex-col overflow-x-hidden">

  <!-- HEADER M√ìVIL -->
  <header class="flex justify-between items-center lg:hidden p-4">
    <a routerLink="/home/inicio" class="text-2xl font-bold text-white">Portafolio</a>
    <button (click)="sidebarOpen = !sidebarOpen" class="text-white text-3xl">&#9776;</button>
  </header>

  <!-- TEMPLATE LINKS REUTILIZABLE -->
  <ng-template #mainLinks>
    <a routerLink="/home/inicio" class="nav-link">Inicio</a>
    <a routerLink="/home/proyectos" class="nav-link">Proyectos</a>

    @if (isUser) {
      <a routerLink="/home/user/solicitudes" class="nav-link">Mis solicitudes</a>
    }

    @if (isAdmin) {
      <a routerLink="/home/admin" class="nav-link">Panel Admin</a>
    }

    @if (isProgrammer) {
      <a routerLink="/home/programmer" class="nav-link">Dashboard</a>
    }
  </ng-template>

  <!-- SIDEBAR M√ìVIL -->
  <aside
    class="fixed inset-y-0 left-0 w-64 bg-black/70 p-6 z-40 transform transition-transform lg:hidden"
    [class.translate-x-0]="sidebarOpen"
    [class.-translate-x-full]="!sidebarOpen">

    <a routerLink="/home/inicio" class="text-2xl font-bold text-white">Portafolio</a>

    <nav class="mt-8 flex flex-col gap-2">
      <ng-container *ngTemplateOutlet="mainLinks"></ng-container>
    </nav>

    <div class="mt-auto flex flex-col items-center gap-3">
      @if (isLogged) {
        <div class="user-initials">{{ getInitials(user?.email ?? '') }}</div>
        <button (click)="logout()" class="logout-btn">Cerrar sesi√≥n</button>
      } @else {
        <button routerLink="/login" class="logout-btn">Iniciar sesi√≥n</button>
      }
    </div>
  </aside>

  <!-- NAVBAR DESKTOP -->
  <nav class="hidden lg:flex justify-between items-center px-10 py-4 bg-black/40 backdrop-blur-xl border-b border-white/10">

    <a routerLink="/home/inicio" class="text-3xl font-bold text-white">Portafolio</a>

    <div class="flex items-center gap-4">
      <ng-container *ngTemplateOutlet="mainLinks"></ng-container>

      @if (isLogged) {
        <div class="user-chip">{{ getInitials(user?.email ?? '') }}</div>
        <button (click)="logout()" class="logout-btn">Cerrar sesi√≥n</button>
      } @else {
        <button routerLink="/login" class="logout-btn">Iniciar sesi√≥n</button>
      }
    </div>
  </nav>

  <!-- CONTENIDO -->
 <main class="flex-1 p-6 mt-20">
  <router-outlet></router-outlet>

 <!-- SECCI√ìN ASESOR√çAS -->
<div
  class="mt-16 bg-gradient-to-r from-indigo-500 to-purple-600
         rounded-2xl p-8 md:p-10 text-white shadow-xl">

  <div class="flex flex-col md:flex-row items-center justify-between gap-8">

    <!-- TEXTO -->
    <div class="md:w-2/3 text-center md:text-left space-y-4">

      <h2 class="text-2xl md:text-3xl font-extrabold">
        ¬øNecesitas ayuda profesional?
      </h2>

      <p class="text-base md:text-lg opacity-90">
        Conecta con programadores expertos, agenda tu asesor√≠a y recibe
        acompa√±amiento personalizado para tus proyectos acad√©micos o profesionales.
      </p>

      @if (isUser) {
        <button
          (click)="showAsesoriaModal.set(true)"
          class="mt-4 inline-flex items-center gap-2
                 px-6 py-2.5 bg-white text-indigo-600
                 rounded-xl font-semibold
                 hover:bg-gray-100 transition-all
                 shadow-md">
          üí¨ Solicitar Asesor√≠a
        </button>
      }

    </div>

    <!-- IMAGEN -->
    <div class="md:w-1/3
     flex justify-center">
      <img
        src="asesora.png"
        alt="Asesor√≠as"
         class="w-40 md:w-52 drop-shadow-2xl">
    </div>

  </div>
</div>


  @if (showAsesoriaModal()) {
    <div class="fixed inset-0 flex items-center justify-center bg-black/50 z-50">
      <div class="bg-white p-6 rounded-lg w-11/12 max-w-lg relative">
        <button
          (click)="showAsesoriaModal.set(false)"
          class="absolute top-2 right-2 text-red-700 text-2xl">
          &times;
        </button>

        <!-- MODAL -->
        <app-advice></app-advice>
      </div>
    </div>
  }
</main>


 <footer class="footer w-screen flex flex-col lg:flex-row justify-between items-start lg:items-center gap-10 py-12 px-8 md:px-12 lg:px-16 bg-black text-white rounded-t-[3rem] shadow-[0_-5px_20px_rgba(0,0,0,0.5)] animate-fadeIn border-t border-white/10" role="contentinfo"> <div class="flex flex-col gap-4 max-w-sm shrink-0"> <div class="flex items-center gap-3"> <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-extrabold text-xl shadow-lg"> üöÄ </div> <span class="text-xl font-bold">Portafolio App</span> </div> <p class="text-white/80 text-base"> Innovando la forma de gestionar tus proyectos y conectarte con expertos. </p> </div> <div class="flex flex-col lg:flex-row lg:justify-between lg:space-x-16 lg:w-3/4"> <div class="grid grid-cols-2 sm:grid-cols-3 gap-x-12 gap-y-6 text-white text-sm font-medium lg:order-1"> <div class="flex flex-col gap-2"> <span class="font-bold text-lg text-red-500 mb-1">Explorar</span> <a routerLink="/home/inicio" class="hover:text-red-400 transition duration-300">Inicio</a> <a routerLink="/home/proyectos" class="hover:text-red-400 transition duration-300">Proyectos</a> <a routerLink="/home/about-us" class="hover:text-red-400 transition duration-300">Qui√©nes somos</a> @if (role === 'admin') { <a routerLink="/home/admin" class="hover:text-red-400 transition duration-300">Panel Admin</a> } </div> <div class="flex flex-col gap-2"> <span class="font-bold text-lg text-red-500 mb-1">Servicios</span> <span class="hover:text-red-400 transition duration-300">Asesor√≠a personalizada</span> <span class="hover:text-red-400 transition duration-300">Gesti√≥n de proyectos</span> <span class="hover:text-red-400 transition duration-300">Consultor√≠a</span> </div> <div class="flex flex-col gap-2"> <span class="font-bold text-lg text-red-500 mb-1">Contacto</span> <span class="text-white/70 text-sm">cajamarcanaye@gmail.com</span> <span class="text-white/70 text-sm">+593 990620997</span> <span class="text-white/70 text-sm">Ecuador, Cuenca</span> </div> </div> <div class="flex flex-col gap-4 items-start mt-8 lg:mt-0 lg:items-center lg:order-2"> <span class="font-bold text-lg text-red-500">S√≠guenos</span> <div class="flex gap-6 text-2xl"> <a href="https://facebook.com" target="_blank" aria-label="Facebook" class="text-white/80 hover:text-blue-500 transition transform hover:scale-110"> <i class="fa-brands fa-facebook-f"></i> </a> <a href="https://www.instagram.com/jordyromero_?igsh=Z3lpZGRpMnRmNWxh" target="_blank" aria-label="Instagram" class="text-white/80 hover:text-pink-500 transition transform hover:scale-110"> <i class="fa-brands fa-instagram"></i> </a> <a href="https://wa.me/593990620997" target="_blank" aria-label="WhatsApp" class="text-white/80 hover:text-green-500 transition transform hover:scale-110"> <i class="fa-brands fa-whatsapp"></i> </a> </div> <div class="text-sm text-white/50 pt-4 mt-auto w-full lg:w-auto lg:text-center border-t border-white/10 lg:border-none"> ¬© 2025 MiApp. Todos los derechos reservados. </div> </div> </div> </footer>

</div>
}
